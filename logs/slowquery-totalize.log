
# 22.2s user time, 50ms system time, 31.25M rss, 39.28M vsz
# Current date: Sun Jun  5 11:14:37 2022
# Hostname: ip-10-0-0-56
# Files: /home/isucon/webapp/mysql/logs/mysql-slow.log
# Overall: 418.19k total, 40 unique, 2.81k QPS, 3.56x concurrency ________
# Time range: 2022-06-05T11:11:49 to 2022-06-05T11:14:18
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time           530s     1us      7s     1ms     1ms    59ms   108us
# Lock time             2s       0   165ms     3us     1us   391us     1us
# Rows sent         22.60M       0 252.81k   56.67    0.99   3.58k    0.99
# Rows examine     369.15M       0  19.76M  925.61   62.76  54.44k    0.99
# Query size        20.61M       6     417   51.67  112.70   26.43   34.95

# Profile
# Rank Query ID                     Response time  Calls  R/Call V/M   Ite
# ==== ============================ ============== ====== ====== ===== ===
#    1 0x4FFEDD9537D4E9B44DEB7A2... 342.5517 64.7%     97 3.5315  0.70 SELECT playlist_favorite
#    2 0xEC063962A0903583D4BF22B...  46.1534  8.7%  38357 0.0012  0.01 SELECT playlist_favorite
#    3 0xCFDD294F672FC7ED341FAC0...  44.7410  8.4% 123070 0.0004  0.00 SELECT song
#    4 0x75F43F95B7E689606BBB5B7...  25.0354  4.7% 123070 0.0002  0.00 SELECT artist
#    5 0x8AFB70E4EF33ECB86281555...  11.7765  2.2%  35275 0.0003  0.00 SELECT playlist_song
#    6 0x3B7F9C3BFD4303564EFFC05...  11.6363  2.2%   1682 0.0069  0.00 INSERT playlist_favorite
#    7 0xFF9A94BDE38FB778640C906...   9.5263  1.8%  27018 0.0004  0.00 SELECT playlist
#    8 0xBB803527F0B05ED37FAF2BB...   6.8265  1.3%      1 6.8265  0.00 DELETE SELECT playlist_song playlist
#    9 0xFE201CF788CDAF0ED135116...   6.6000  1.2%  19512 0.0003  0.01 SELECT user
# MISC 0xMISC                        24.9816  4.7%  50105 0.0005   0.0 <31 ITEMS>

# Query 1: 1.39 QPS, 4.89x concurrency, ID 0x4FFEDD9537D4E9B44DEB7A24247FE1ED at byte 95746408
# Scores: V/M = 0.70
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:16
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0      97
# Exec time     64    343s   657ms      7s      4s      6s      2s      4s
# Lock time      0   116us       0    18us     1us     1us     1us     1us
# Rows sent     97  22.05M   2.14k 252.81k 232.80k 245.21k  64.98k 245.21k
# Rows examine  78 288.43M   2.75M   2.99M   2.97M   2.88M  38.68k   2.88M
# Query size     0  10.70k     113     113     113     113       0     113
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms  ##
#    1s  ################################################################
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist_favorite'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist_favorite`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT playlist_id, count(*) AS favorite_count FROM playlist_favorite GROUP BY playlist_id ORDER BY count(*) DESC\G

# Query 2: 555.90 QPS, 0.67x concurrency, ID 0xEC063962A0903583D4BF22B4F6620A35 at byte 71784690
# Scores: V/M = 0.01
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          9   38357
# Exec time      8     46s    57us    69ms     1ms     5ms     3ms   185us
# Lock time      5    77ms       0     5ms     1us     1us    37us     1us
# Rows sent      0  37.46k       1       1       1       1       0       1
# Rows examine  15  56.08M       0  14.65k   1.50k  14.47k   3.52k    9.83
# Query size    12   2.63M      69      72   71.82   69.19    0.06   69.19
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  ############
# 100us  ################################################################
#   1ms  ##################
#  10ms  ##
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist_favorite'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist_favorite`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT COUNT(*) AS cnt FROM playlist_favorite where playlist_id = 90348\G

# Query 3: 1.78k QPS, 0.65x concurrency, ID 0xCFDD294F672FC7ED341FAC0294AB364A at byte 81769141
# Scores: V/M = 0.00
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         29  123070
# Exec time      8     45s    45us    56ms   363us   972us     1ms   108us
# Lock time     14   218ms       0     6ms     1us     1us    24us     1us
# Rows sent      0 120.19k       1       1       1       1       0       1
# Rows examine   0 120.19k       1       1       1       1       0       1
# Query size    20   4.21M      32      36   35.85   34.95    0.26   34.95
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  ###############################################
# 100us  ################################################################
#   1ms  #####
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'song'\G
#    SHOW CREATE TABLE `isucon_listen80`.`song`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM song WHERE id = 68966\G

# Query 4: 1.78k QPS, 0.36x concurrency, ID 0x75F43F95B7E689606BBB5B7D6427CFC1 at byte 71897626
# Scores: V/M = 0.00
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         29  123070
# Exec time      4     25s    39us    41ms   203us   568us   560us    84us
# Lock time     15   239ms       0     4ms     1us     1us    27us     1us
# Rows sent      0 120.19k       1       1       1       1       0       1
# Rows examine   0 120.19k       1       1       1       1       0       1
# Query size    20   4.18M      33      36   35.63   34.95    0.35   34.95
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  ################################################################
# 100us  ##############################################
#   1ms  ##
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'artist'\G
#    SHOW CREATE TABLE `isucon_listen80`.`artist`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM artist WHERE id = 2108\G

# Query 5: 511.23 QPS, 0.17x concurrency, ID 0x8AFB70E4EF33ECB862815558CB07356A at byte 111752434
# Scores: V/M = 0.00
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          8   35275
# Exec time      2     12s    59us    51ms   333us   925us     1ms   131us
# Lock time      4    66ms       0     2ms     1us     1us    23us     1us
# Rows sent      0  34.45k       1       1       1       1       0       1
# Rows examine   0   1.38M       0      79   41.13   72.65   22.41   40.45
# Query size    11   2.28M      65      68   67.82   65.89    0.06   65.89
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  #####
# 100us  ################################################################
#   1ms  ###
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist_song'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist_song`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT COUNT(*) AS cnt FROM playlist_song where playlist_id = 180624\G

# Query 6: 24.38 QPS, 0.17x concurrency, ID 0x3B7F9C3BFD4303564EFFC05B3903B6C4 at byte 111158876
# Scores: V/M = 0.00
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0    1682
# Exec time      2     12s     3ms    64ms     7ms    14ms     4ms     5ms
# Lock time      0     4ms       0   900us     2us     1us    24us     1us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   0       0       0       0       0       0       0       0
# Query size     1 253.36k     147     168  154.24  158.58    4.02  151.03
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms  ################################################################
#  10ms  ###########
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist_favorite'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist_favorite`\G
INSERT INTO playlist_favorite (`playlist_id`, `favorite_user_account`, `created_at`) VALUES (361416, 'decisionmoneyhuge', '2022-06-05 11:13:12.296230325')\G

# Query 7: 391.57 QPS, 0.14x concurrency, ID 0xFF9A94BDE38FB778640C90666343546B at byte 80394151
# Scores: V/M = 0.00
# Time range: 2022-06-05T11:12:06 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          6   27018
# Exec time      1     10s    48us    32ms   352us     1ms     1ms    98us
# Lock time      2    46ms       0     3ms     1us     1us    29us     1us
# Rows sent      0  26.38k       1       1       1       1       0       1
# Rows examine   0  26.38k       1       1       1       1       0       1
# Query size     5   1.07M      38      42   41.71   40.45    0.43   40.45
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  #############################################################
# 100us  ################################################################
#   1ms  ######
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM playlist WHERE `id` = 91121\G

# Query 8: 0 QPS, 0x concurrency, ID 0xBB803527F0B05ED37FAF2BBD29AD2CB4 at byte 2363
# Scores: V/M = 0.00
# Time range: all events occurred at 2022-06-05T11:12:00
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          0       1
# Exec time      1      7s      7s      7s      7s      7s       0      7s
# Lock time      0     8us     8us     8us     8us     8us       0     8us
# Rows sent      0       0       0       0       0       0       0       0
# Rows examine   5  19.76M  19.76M  19.76M  19.76M  19.76M       0  19.76M
# Query size     0      76      76      76      76      76       0      76
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us
# 100us
#   1ms
#  10ms
# 100ms
#    1s  ################################################################
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist_song'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist_song`\G
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'playlist'\G
#    SHOW CREATE TABLE `isucon_listen80`.`playlist`\G
DELETE FROM playlist_song WHERE playlist_id NOT IN (SELECT id FROM playlist)\G
# Converted for EXPLAIN
# EXPLAIN /*!50100 PARTITIONS*/
select * from  playlist_song WHERE playlist_id NOT IN (SELECT id FROM playlist)\G

# Query 9: 274.82 QPS, 0.09x concurrency, ID 0xFE201CF788CDAF0ED13511641E92D414 at byte 37731018
# Scores: V/M = 0.01
# Time range: 2022-06-05T11:12:04 to 2022-06-05T11:13:15
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count          4   19512
# Exec time      1      7s    50us    52ms   338us   881us     1ms   103us
# Lock time      1    29ms       0   746us     1us     1us    11us     1us
# Rows sent      0  19.05k       1       1       1       1       0       1
# Rows examine   0  19.05k       1       1       1       1       0       1
# Query size     4   1.03M      47      70   55.33   59.77    3.62   54.21
# String:
# Databases    isucon_listen80
# Hosts        webapp-app-1.webapp_default
# Users        isucon
# Query_time distribution
#   1us
#  10us  ##################################################
# 100us  ################################################################
#   1ms  #####
#  10ms  #
# 100ms
#    1s
#  10s+
# Tables
#    SHOW TABLE STATUS FROM `isucon_listen80` LIKE 'user'\G
#    SHOW CREATE TABLE `isucon_listen80`.`user`\G
# EXPLAIN /*!50100 PARTITIONS*/
SELECT * FROM user WHERE `account` = 'hundredboysummer'\G
